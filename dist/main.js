(()=>{"use strict";class e{constructor({data:e,handleCardClick:t},n){this._name=e.name,this._link=e.link,this._templateSelector=n,this._handleCardClick=t}_getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(".element").cloneNode(!0)}generateCard(){return this._element=this._getTemplate(),this._cardPhoto=this._element.querySelector(".element__image"),this._cardTitle=this._element.querySelector(".element__name"),this._cardLikeButton=this._element.querySelector(".element__like"),this._cardDeleateButton=this._element.querySelector(".element__delete"),this._cardPhoto.src=this._link,this._cardPhoto.alt=this._name,this._cardTitle.textContent=this._name,this._setEventListeners(),this._element}_deletePhotoElement=()=>{this._element.remove()};_toggleLikeOnPhoto(){this._cardLikeButton.classList.toggle("element__action_like")}_setEventListeners(){this._cardDeleateButton.addEventListener("click",this._deletePhotoElement),this._cardLikeButton.addEventListener("click",(()=>{this._toggleLikeOnPhoto()})),this._element.addEventListener("click",(()=>{this._handleCardClick(this._name,this._link)}))}}class t{constructor(e,t){this._config=e,this._formElement=t,this._buttonSubmit=this._formElement.querySelector(this._config.buttonSelector)}enableValidation(){this._addInputListeners(),this._toggleButton()}_showInputError=e=>{this._inputId=e.id,this._errorElement=this._formElement.querySelector(`#${this._inputId}-error`),e.classList.add(this._config.inputErrorClass),this._errorElement.textContent=e.validationMessage};_hideInputError=e=>{this._inputId=e.id,this._errorElement=this._formElement.querySelector(`#${this._inputId}-error`),e.classList.remove(this._config.inputErrorClass),this._errorElement.textContent=""};_handleFormInput=e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e)};resetValidation(){this._toggleButton(),this._inputList.forEach((e=>{this._hideInputError(e)}))}_toggleButton(){this._formElement.checkValidity()?this.activeButton():this.deactiveButton()}activeButton(){this._buttonSubmit.disabled=!1,this._buttonSubmit.classList.remove(this._buttonDisabled)}deactiveButton(){this._buttonSubmit.disabled=!0,this._buttonSubmit.classList.add(this._buttonDisabled)}_addInputListeners(){this._inputList=Array.from(this._formElement.querySelectorAll(this._config.inputSelector)),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._handleFormInput(e),this._toggleButton()}))}))}}class n{constructor(e){this._popupSelector=document.querySelector(e),this._buttonClose=this._popupSelector.querySelector(".popup__close-button"),this._formList=Array.from(document.querySelectorAll(".popup"))}open(){this._popupSelector.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupSelector.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._buttonClose.addEventListener("click",(()=>{this.close()})),this._popupSelector.addEventListener("click",(e=>{e.target.classList.contains("popup_opened")&&this.close(),e.target.classList.contains(".popup__close-button")&&this.close()}))}}class s extends n{constructor(e,{handleFormSubmit:t}){super(e),this._formSelector=this._popupSelector.querySelector(".popup__form"),this._handleFormSubmit=t}_getInputValues(){return this._inputList=this._popupSelector.querySelectorAll(".popup__input"),this._newInputValues={},this._inputList.forEach((e=>{this._newInputValues[e.name]=e.value})),this._newInputValues}close(){this._formSelector.reset(),super.close()}setEventListeners(){super.setEventListeners(),this._formSelector.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this.close()}))}}const o=[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],r={inputSelector:".popup__input",errorClass:"popup__input_type_error",buttonSelector:".popup__button",buttonDisabled:"popup__button_disabled"},i=document.querySelector(".profile__edit-button"),l=document.querySelector(".profile__add-button"),a=document.querySelector(".popup__edit-form"),c=document.querySelector(".popup__add-form"),p=(document.querySelector(".popup__input_add_place"),document.querySelector(".popup__input_add_link"),document.querySelector(".popup__input_edit_name")),_=document.querySelector(".popup__input_edit_about"),u=(document.querySelector("#view-photo"),new t(r,a)),d=new t(r,c);u.enableValidation(),d.enableValidation();const h=new class{constructor({items:e,renderer:t},n){this._renderedItems=e,this._renderer=t,this._container=document.querySelector(n)}addItem(e){this._container.prepend(e)}renderItems(){this._renderedItems.forEach((e=>this._renderer(e)))}}({items:o,renderer:t=>{const n=new e({data:t,handleCardClick:(e,t)=>{}},"#element-template").generateCard();h.addItem(n)}},".elements");h.renderItems(o);const m=new s(".popup_add_card",{handleFormSubmit:({name:t,link:n})=>{const s=new e({data:{name:t,link:n},handleCardClick:()=>{S.open(t,n),d._toggleButton(),d.resetValidation()}},"#element-template",(()=>{S.open(t,n)})).generateCard();h.addItem(s),m.close()}},".elements");m.setEventListeners();const S=new class extends n{constructor(e){super(e),this._photoName=this._popupSelector.querySelector(".popup__caption"),this._photoLink=this._popupSelector.querySelector(".popup__image")}open(e,t){super.open(),this._photoName.textContent=e,this._photoLink.src=t,this._photoName.alt=e}}(".popup_card_image");S.setEventListeners(),document.querySelectorAll(".element__image").forEach((e=>{e.addEventListener("click",(e=>{S.open(e.target.alt,e.target.src)}))})),l.addEventListener("click",(()=>{m.open()}));const b=new class{constructor({userName:e,job:t}){this._name=document.querySelector(e),this._job=document.querySelector(t)}getUserInfo(){return{name:this._name.textContent,job:this._job.textContent}}setUserInfo(e,t){this._name.textContent=e,this._job.textContent=t}}({userName:".profile__name",job:".profile__subtitle"}),y=new s(".popup_edit",{handleFormSubmit:e=>{b.setUserInfo(e.name,e.job)}});y.setEventListeners(),i.addEventListener("click",(function(){y.open(),p.value=b.getUserInfo().name,_.value=b.getUserInfo().job}))})();